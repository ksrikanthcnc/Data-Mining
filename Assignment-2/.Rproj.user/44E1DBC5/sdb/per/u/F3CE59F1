{
    "collab_server" : "",
    "contents" : "library(neuralnet)\ndata <- read_csv(\"data.csv\")\ndata <- data[1:10000,]\ndata[sapply(data, is.character)] <- lapply(data[sapply(data, is.character)], as.factor)\nincome = ifelse( data$income == \"Low\", 0,1)\ndata = data[,-14]\ndata = data.frame(data, income)\n\nn <- names(data)\nf <- as.formula(paste(\"~\", paste(n, collapse = \" + \")))\nm <- model.matrix( f,data = data)\n\nl=m\nm <- as.data.frame(m)\nintrain <- createDataPartition(y = m$income, p = 0.8, list = FALSE)\ntrain <- m[intrain,]\ntest <- m[-intrain,]\n\n#View(m)\nn <- names(m)\nf <- as.formula(paste(\"income~\", paste(sprintf(\"`%s`\", n[!n %in% \"income\"]), collapse=\"+\")))\nr <- neuralnet( f,\n                data=m, hidden=0, threshold=0.01\n)\nplot(r)\nplot.nn(r)\n\ninstall.packages(\"devtools\")\nlibrary(devtools)\nsource_url('https://gist.githubusercontent.com/fawda123/7471137/raw/466c1474d0a505ff044412703516c34f1a4684a5/nnet_plot_update.r')\n#plot each model\nplot.nnet(nn)\nplot.nnet(mod2)\nplot.nnet(mod3)\n\n\nnn <- nnet(income ~ ., data=train,size=2, decay=5e-4, maxit=200)\nplot.nnet(nn)\nnn\npred <- prediction(r, q)\na\n\nq = test[,-82]\nsummary(q)\nlength(q)\npred <- compute(r, q)\npred$neurons\n\n\nconf <- table(pred,test$income)\ncat(\"Confusion Matrix\",\"\\n\")\nprint(conf)\nr=recall(as.factor(pred), test$income)\np=precision(as.factor(pred), test$income)\ncat(\"Accuracy\",sum(diag(conf))/sum(conf),\"\\n\")\ncat(\"Recall\",recall(as.factor(pred), test$income),\"\\n\")\ncat(\"Precision\",precision(as.factor(pred), test$income),\"\\n\")\ncat(\"F-Score\",(2*r*p)/(r+p),\"\\n\")\npred <- predict(model, test, type = 'prob')\nauc<-auc(test$income,predicted[,2])\nplot(roc(test$income,predicted[,2]))\ncat(\"AUC\",auc,\"\\n\")\n\n",
    "created" : 1509291990725.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "3187572570",
    "id" : "F3CE59F1",
    "lastKnownWriteTime" : 49007528,
    "last_content_update" : 1509291992350,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled4"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}